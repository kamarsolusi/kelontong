var qty=0,subtotal=0,grandTotal=0,idCart=0,totalPajak=0;function totalBeli(){grandTotal=0,$(".sub-total").each(function(){var t=$.trim($(this).text());t&&(t=1e3*parseFloat(t.replace(/^\Rp./,"")),grandTotal+=t)}),$("#grand-total").text("Rp. "+Intl.NumberFormat("id").format(grandTotal)),pajak(grandTotal)}function minus(t){qty=$("#qty-"+t).text(),idCart=t;var a=$("#harga-"+t).text();a=1e3*parseFloat(a.replace(/^\Rp./,"")),qty--,$.ajax({url:"../carts/"+t,data:"qty="+qty,method:"post",dataType:"json",success:function(e){$("#qty-"+t).text(qty),subtotal=qty*a,$("#sub-total-"+t).text("Rp. "+Intl.NumberFormat("id").format(subtotal)),1==qty&&$("#minus-"+t).addClass("disabled"),totalBeli()}})}function plus(t){qty=$("#qty-"+t).text();var a=$("#harga-"+t).text();a=1e3*parseFloat(a.replace(/^\Rp./,"")),qty++,$.ajax({url:"../carts/"+t,data:"qty="+qty,method:"post",dataType:"json",success:function(e){$("#qty-"+t).text(qty),subtotal=qty*a,$("#sub-total-"+t).text("Rp. "+Intl.NumberFormat("id").format(subtotal)),$("#minus-"+t).removeClass("disabled"),totalBeli()}})}function pajak(t){totalPajak=.1*t,$("#tax").text("Rp. "+Intl.NumberFormat("id").format(totalPajak)),totalBayar(totalPajak,t)}function totalBayar(t,a){var e=a+t;$("#total-bayar").text("Rp. "+Intl.NumberFormat("id").format(e))}function deleteData(t){$.ajax({url:"../carts/"+t,method:"delete",dataType:"json",success:function(t){200==t.status&&(table.ajax.reload(),shoppingCart(),totalBeli(),Swal.fire({toast:!0,icon:"success",position:"top-end",title:"Deleted Successfully !",timer:3e3,showConfirmButton:!1}))}})}$(document).ready(function(){table=$("#cart-body").DataTable({ajax:{url:"../carts/show",dataSrc:"results",dataType:"json",method:"GET"},responsive:!0,bInfo:!1,paging:!1,lengthChange:!1,ordering:!1,processing:!1,serverSide:!1,retrieve:!0,language:{processing:"Sedang memuat data..",decimal:",",thousands:"."},columns:[{data:null,sortable:!1,render:function(t,a,e,r){return r.row+1}},{data:"name"},{data:"qty",mRender:function(t,a,e){var r=1==t?"disabled":"";return"<a onclick='minus("+e.cart_id+")' class='btn btn-danger text-light btn-sm "+r+"' id='minus-"+e.cart_id+"'> - </a>\n                     <a id='qty-"+e.cart_id+"' class='text-light btn btn-primary'>"+t+"</a> \n                     <a  onclick='plus("+e.cart_id+")' class='btn btn-success text-light btn-sm'> + </a>"}},{data:"harga_baru",mRender:function(t,a,e,r){return"<p id='harga-"+e.cart_id+"'>Rp. "+r.settings.fnFormatNumber(e.harga_baru)+"</p>"}},{data:"harga_baru",mRender:function(t,a,e,r){return"<b class='sub-total' id='sub-total-"+e.cart_id+"' >Rp. "+r.settings.fnFormatNumber(e.harga_baru*e.qty)+"</b>"}},{data:"cart_id",render:function(t){return'\n                        <a class="btn btn-danger text-light" onclick="deleteData('+t+')"><i class="fas fa-trash-alt"></i> Hapus</a>\n                        '}}],initComplete:function(t,a){totalBeli()}})});