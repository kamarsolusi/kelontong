var table,base=window.location.origin;function submit(a){$("#product_id").val(""),$("#sku").val(""),$("#name").val(""),$("#category_id").val(""),$("#category_id").empty(),$("#harga").val(""),$("#stok").val(""),$("#status").val(""),"tambah"==a?($("#myModalTitle").text("Tambah Data"),$("#btn-tambah").show(),$("#btn-ubah").hide(),$.ajax({url:"../admin/categories/active",type:"get",dataType:"json",success:function(a){$.each(a.results,function(a,t){$("#category_id").append("\n                        <option value='"+t.category_id+"'>"+t.category_name+"</option>\n                    ")})}})):($("#myModalTitle").text("Ubah Data"),$("#btn-tambah").hide(),$("#btn-ubah").show(),$.ajax({url:"../admin/products/"+a,type:"get",dataType:"json",success:function(a){$.each(a.category,function(a,t){$("#category_id").append("\n                            <option value='"+t.category_id+"'>"+t.category_name+"</option>\n                            ")}),$.each(a.product,function(a,t){$("#product_id").val(t.product_id),$("#sku").val(t.sku),$("#name").val(t.name),$("#category_id").val(t.category_id),$("#harga").val(t.harga_baru),$("#stok").val(t.stok),$("#status").val(t.product_status)})},error:function(a){console.log(a)}}))}function updateData(){var a=$("#product_id").val(),t=$("#sku").val(),e=$("#name").val(),n=$("#category_id").val(),o=$("#harga").val(),s=$("#stok").val(),i=$("#status").val();$.ajax({url:"../admin/products/update/"+a,type:"post",data:"sku="+t+"&name="+e+"&category_id="+n+"&harga="+o+"&stok="+s+"&status="+i,dataType:"json",success:function(){$("#myModal").modal("hide"),table.ajax.reload(),Swal.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,icon:"success",title:"Update Data Successfully"})},error:function(a){console.log(a)}})}function tambahData(){var a=$("#sku").val(),t=$("#name").val(),e=$("#category_id").val(),n=$("#harga").val(),o=$("#stok").val(),s=$("#status").val();$.ajax({url:"../admin/products/add",type:"post",data:"sku="+a+"&name="+t+"&category_id="+e+"&harga="+n+"&stok="+o+"&status="+s,dataType:"json",success:function(a){200==a.status&&(table.ajax.reload(),$("#myModal").modal("hide"),Swal.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,icon:"success",title:"Data Inserted Successfully"}))}})}function deleteData(a){Swal.fire({title:"Apakah anda yakin?",icon:"warning",showCancelButton:!0,confirmButtonText:"Iya, Hapus saja!",cancelButtonText:"Tidak, Batal!",customClass:{confirmButton:"btn btn-danger mr-3",cancelButton:"btn btn-primary"},buttonsStyling:!1}).then(t=>{t.isConfirmed?$.ajax({url:"../admin/products/"+a,type:"delete",error:function(a){Swal.fire({title:"Someting is wrong",icon:"warning",text:a})},success:function(){table.ajax.reload(),Swal.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,icon:"success",title:"Data Deleted Successfully"})}}):Swal.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,icon:"info",title:"Change are not save!",text:"Your data is saved!"})})}$(document).ready(function(){table=$("#table-product").DataTable({ajax:{url:"../admin/products/show",dataSrc:"results",dataType:"json",type:"GET"},responsive:!0,bInfo:!1,lengthMenu:[[5,10,25],[5,10,25]],lengthChange:!0,bProcessing:!0,retrieve:!0,language:{processing:"Sedang memuat data..",decimal:",",thousands:"."},columns:[{data:null,sortable:!1,render:function(a,t,e,n){return n.row+1}},{data:"sku"},{data:"name"},{data:"category_name"},{data:"harga_baru",render:$.fn.dataTable.render.number(",",".",2,"Rp ")},{data:"stok"},{data:"product_status",mRender:function(a){return"ACTIVE"==a?"<a class='btn btn-info'><i class=\"fas fa-check-circle mr-2\"></i>"+a+"</a>":"<a class='btn btn-danger'><i class=\"fas fa-times-circle mr-2\"></i>"+a+"</a>"}},{data:"sku",render:function(a){return'\n                        <a target="_blank" href="'+base+"/admin/products/images/"+a+'" class="btn btn-secondary"><i class="fas fa-images"></i> Picture</a>\n                        <a data-toggle="modal" onclick="submit('+a+')" class="btn btn-success" data-target="#myModal" ><i class="fas fa-edit"></i>Edit</a> \n                        <a class="btn btn-danger" onclick="deleteData('+a+')"><i class="fas fa-trash-alt"></i>Hapus</a>\n                        '}}]})});